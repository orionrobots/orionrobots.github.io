# Use PHP5.4 as default
AddHandler application/x-httpd-php54 .php
#AddHandler php53-fcgi .php

#
# Please find more info here
# http://doc.tiki.org/Rewrite+Rules

# This prevents reading of files with certain extensions.
<FilesMatch "\.(bak|inc|lib|sh|tpl|sql)$">
	order deny,allow
	deny from all
</FilesMatch>

<IfModule mod_dir.c>
    DirectoryIndex index.html index.php
</IfModule>

<IfModule deflate_module>
	AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/x-javascript application/javascript
</IfModule>

# Using ETags will improve the YSlow scores
FileETag none

# If the site is stable, might be worth setting the expires header on all files for optimization.
<IfModule mod_expires.c>
	<FilesMatch "\.(js|png|gif|jpg|css|ico)$">
		ExpiresActive on
		ExpiresDefault "access plus 6 months"
	</FilesMatch>
</IfModule>

ErrorDocument 404 /404.html
ErrorDocument 501 /404.html

<IfModule mod_autoindex.c>
    IndexOptions IgnoreCase FancyIndexing FoldersFirst NameWidth=* DescriptionWidth=* SuppressHTMLPreamble
    # SET DISPLAY ORDER
    IndexOrderDefault Descending Name
    # SPECIFY HEADER FILE
    HeaderName /directory_head.html

    # SPECIFY FOOTER FILE
    ReadmeName /directory_footer.html
</IfModule>

# Permanent redirect: Add directive as the example below. This is useful if you were using another Web application or static HTML and you want to avoid broken links.
# Redirect 301 /oldpage.html /tiki-index.php?page=newpage

<IfModule mod_rewrite.c>
RewriteEngine On

## FORUMS

RewriteRule ^forum([0-9]+)(.*)     tiki-view_forum.php?forumId=$1$2         [QSA]
RewriteRule ^forumthread([0-9]+)(.*) tiki-view_forum_thread.php?comments_parentId=$1$2 [QSA]

# Forum topics redirect section
RewriteRule "^tiki-view_forum.php\?forumId=5(.*)" /forums/open_discussion [RL]
RewriteRule "^tiki-view_forum.php\?forumId=8(.*)" /forums/lego_discussion [RL]
RewriteRule "^tiki-view_forum.php\?forumId=1(.*)" /forums/announcements [RL]
RewriteRule "^tiki-view_forum.php\?forumId=2(.*)" /forums/electronics [RL]
RewriteRule "^tiki-view_forum.php\?forumId=7(.*)" /forums/site_feedback [RL]
RewriteRule "^tiki-view_forum.php\?forumId=6(.*)" /forums/robot_market [RL]
RewriteRule "^tiki-view_forum.php\?forumId=11(.*)" /forums/vex [RL]
RewriteRule "^tiki-view_forum.php\?forumId=3(.*)" /forums/pneumatics_hydraulics [RL]
RewriteRule "^tiki-view_forum.php\?forumId=12(.*)" /forums/orion_explorer_1_robot_kit [RL]

# Forum topic threads redirect section
# redirects for topic orion_explorer_1_robot_kit
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=473(.*)" /forums/orion_explorer_1_robot_kit/welcome_to_the_explorer_1_forum_forum_rules_and_introduction [RL]
# redirects for topic lego_discussion
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=113(.*)" /forums/lego_discussion/mindstorms_stormrunner_game [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=234(.*)" /forums/lego_discussion/help_light_chasing_robot [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=259(.*)" /forums/lego_discussion/help_with_adder_subtractor [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=47(.*)" /forums/lego_discussion/lego_mindstorms_a_good_start [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=238(.*)" /forums/lego_discussion/uk_version_of_cybermaster_software_cd [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=172(.*)" /forums/lego_discussion/rcx_ir_malfunction_help [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=188(.*)" /forums/lego_discussion/rcx_tools_wince_for_x86 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=108(.*)" /forums/lego_discussion/is_serial_communication_with_rcx_ports_possible [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=124(.*)" /forums/lego_discussion/lego_ants_simulation [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=118(.*)" /forums/lego_discussion/problem_in_using_rotationnavigator_class [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=46(.*)" /forums/lego_discussion/robotic_telescope [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=110(.*)" /forums/lego_discussion/lego_ris_2_0 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=68(.*)" /forums/lego_discussion/other_robotics_mailing_lists [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=81(.*)" /forums/lego_discussion/waterproof_housing_for_rcx_originally_u [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=72(.*)" /forums/lego_discussion/what_is_that_displayed_on_my_rcx2_0 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=70(.*)" /forums/lego_discussion/are_there_any_chance_of_video_clips_of_jamocklat_in_action [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=42(.*)" /forums/lego_discussion/balls_for_building_gbc_modules [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=62(.*)" /forums/lego_discussion/rcx_3 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=39(.*)" /forums/lego_discussion/rcx3_can_extra_hardware_functionality_be_added [RL]
# redirects for topic site_feedback
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=439(.*)" /forums/site_feedback/was_some_thing_lost_in_the_face_lift [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=328(.*)" /forums/site_feedback/topic_order [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=320(.*)" /forums/site_feedback/how_can_i_edit_my_profile [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=155(.*)" /forums/site_feedback/forum_suggestions [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=83(.*)" /forums/site_feedback/front_page_looked_bad [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=52(.*)" /forums/site_feedback/queing [RL]
# redirects for topic pneumatics_hydraulics
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=178(.*)" /forums/pneumatics_hydraulics/help_and_advice [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=98(.*)" /forums/pneumatics_hydraulics/links_to_pneumatic [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=84(.*)" /forums/pneumatics_hydraulics/pneumatic_forces [RL]
# redirects for topic vex
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=169(.*)" /forums/vex/vex_robot_from_radio_shack [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=224(.*)" /forums/vex/vex_robotics_questions [RL]
# redirects for topic open_discussion
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=451(.*)" /forums/open_discussion/autonomous_robots_navigation [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=443(.*)" /forums/open_discussion/robotic_10 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=390(.*)" /forums/open_discussion/uk_micromouse_2010 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=373(.*)" /forums/open_discussion/robotic_09 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=367(.*)" /forums/open_discussion/variable_surface_curvature_lego_system [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=357(.*)" /forums/open_discussion/uk_micromouse_2009 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=351(.*)" /forums/open_discussion/robot_wars_dvds_and_vhs_recordings [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=349(.*)" /forums/open_discussion/robotic08 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=337(.*)" /forums/open_discussion/uk_micromouse_2008 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=331(.*)" /forums/open_discussion/rise_of_the_robots [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=327(.*)" /forums/open_discussion/uk_robot_competition [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=324(.*)" /forums/open_discussion/role_of_science_fiction_and_the_advancement_of_robotics [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=322(.*)" /forums/open_discussion/robotics_event_in_india [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=316(.*)" /forums/open_discussion/project_aiko_female_android_demo_2 [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=312(.*)" /forums/open_discussion/robot_builders_in_the_midlands [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=303(.*)" /forums/open_discussion/my_female_android_robot_project_update [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=297(.*)" /forums/open_discussion/need_some_help [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=296(.*)" /forums/open_discussion/more_mini_sumo [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=284(.*)" /forums/open_discussion/mark_tilden_interview [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=282(.*)" /forums/open_discussion/minisumo_competitions [RL]
# redirects for topic robot_market
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=190(.*)" /forums/robot_market/forum_charter [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=448(.*)" /forums/robot_market/kurukshetra_2011_mobile_robotics [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=447(.*)" /forums/robot_market/kurukshetra_2011_scara [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=436(.*)" /forums/robot_market/robot_resource_diretory [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=279(.*)" /forums/robot_market/gimson_robotics_online_store [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=242(.*)" /forums/robot_market/retro_robots [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=192(.*)" /forums/robot_market/gumstix_linux_machine [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=153(.*)" /forums/robot_market/request_for_parts [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=92(.*)" /forums/robot_market/event_uk_xfm_featherweight_challenge [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=26(.*)" /forums/robot_market/robot_builders_required [RL]
# redirects for topic electronics
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=332(.*)" /forums/electronics/i_need_help_with_first_build [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=258(.*)" /forums/electronics/question_from_a_new_member [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=228(.*)" /forums/electronics/cheap_pics_gps_etc [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=176(.*)" /forums/electronics/preferred_microcontrollers [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=105(.*)" /forums/electronics/12vdc [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=51(.*)" /forums/electronics/small_motors [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=35(.*)" /forums/electronics/need_opinions_on_this_robot_controller_system [RL]
# redirects for topic announcements
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=293(.*)" /forums/announcements/problem_with_forums_posts [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=269(.*)" /forums/announcements/downloads_fixed [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=264(.*)" /forums/announcements/planned_outtage [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=231(.*)" /forums/announcements/outtage [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=211(.*)" /forums/announcements/dns_outtage [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=209(.*)" /forums/announcements/file_downloads_now_for_registered_users_only [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=206(.*)" /forums/announcements/one_million_views [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=203(.*)" /forums/announcements/anonymous_posting_broken [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=165(.*)" /forums/announcements/upgrade [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=160(.*)" /forums/announcements/outage_confirmed [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=150(.*)" /forums/announcements/forum_features_updated [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=149(.*)" /forums/announcements/spammers_faking_orionrobots_addresses [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=136(.*)" /forums/announcements/possible_outage [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=107(.*)" /forums/announcements/pdf_generation_disabled [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=61(.*)" /forums/announcements/bumpy_ride [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=31(.*)" /forums/announcements/open_comments [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=28(.*)" /forums/announcements/sandbox_disabled [RL]
RewriteRule "^tiki-view_forum_thread.php\?comments_parentId=1(.*)" /forums/announcements/new_site [RL]




# Non tiki
RewriteRule "^Construction Guide(.*)" /construction_guide.html [R]
RewriteRule "^Construction\+Guide(.*)" /construction_guide.html [R]
RewriteRule "^Getting\+Started(.*)" /getting_started.html [R]
RewriteRule "^Getting Started(.*)" /getting_started.html [R]
RewriteRule "^Leonardo\+Da\+Vincis\+Tank(.*)" /pages/leonardo_da_vincis_tank.html [R]
RewriteRule "^Fixing\+A\+Broken\+Wire(.*)" /2004/11/14/fixing-a-broken-wire [R]
RewriteRule "^Lego\+Specifications(.*)" /pages/lego-specifications.html [R,L]
RewriteRule "^i-Cybie\+Robot\+Dog(.*)" /2004/11/14/i-cybie-robot-dog [R,L]
RewriteRule "^leonardo_da_vincis_tank.html" /pages/leonardo_da_vincis_tank.html [R,L]
RewriteRule "^orion-explorer-faq.html" /products/orion-explorer-faq.html [R,L]
RewriteRule "^Simple+Parallel+Port+LED+Board" /2004/11/05/simple-parallel-port-led.html [R,L]
RewriteRule "^Building+An+Experimenting+Parallel+Cable" /2004/11/05/simple-parallel-port-led.html [R,L]
RewriteRule "^Apache+Monitor+With+Python+And+An+LED" /2004/11/14/apache-monitor-with-led.html [R,L]
RewriteRule "^Robot\+Stores(.*)" /pages/robot-stores.html [R]
RewriteRule "^Sir\+Killalot(.*)" /2005/03/01/sir-killalot/ [R,L]
RewriteRule "^Robotic\+Gadgets\+And\+Toys(.*)" /2005/08/02/robotics-toys-and-gadgets [R,L]
RewriteRule "^[Hh]ome[Pp]age$" /index.html [R]
RewriteRule "^[Mm]ega[Bb]yte\+[Rr]obot\+[Dd]og$" /2004/11/14/megabyte-robot-dog [R,L]
RewriteRule "^USB$" /Universal+Serial+Bus [R]


# Rewrite rules to maintain any hard-coded URLs following http://dev.tiki.org/ImgDirectoryRevamp
RewriteRule ^img/icons2/(.*)$ img/icons/$1 
RewriteRule ^pics/large/(.*)$ img/icons/large/$1
RewriteRule ^img/mytiki/(.*)$ img/icons/large/$1
RewriteRule ^pics/(.*)$ img/$1
RewriteRule ^images/(.*)$ img/icons/$1

# Apache does not pass Authorization header to CGI scripts
# Rewrite rules for passing authorisation in CGI or FGI mode
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule ^(.*) - [E=HTTP_AUTHORIZATION:%1]


# You may need to uncomment and fix the RewriteBase value below to suit your installation. e.g. if your Tiki is not installed directly in the web root.
#RewriteBase   /tiki
# And if you get errors like "The requested URL /absolutepath/tiki-index.php was not found on this server",
# You may need to uncomment the following line.
# RewriteBase   /

#If your website is a checkout
RewriteRule	.*/\.svn/.*	-	[F,L]

# If the URL points to a file then do nothing
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule (.*) - [L]

# Rewrite rule to make this Tiki a profiles repository (uncomment to enable)
# Set the parentId (here set as 1) to the Id of the category containing your profile pages
# See http://doc.tiki.org/Profiles for more
# Note: you need to allow tiki_p_view_category and tiki_p_export_wiki for anonymous to be a repository
#       and enable feature_wiki_export (as well as feature_wiki and feature_categories)
#RewriteRule ^profiles$             tiki-browse_categories.php?find=&deep=on&type=wiki+page&parentId=1&sort_mode=name_asc&plain&maxRecords=1000000 [L]

# Rule to make a short link to a list of object to export as a plain text sitemap
# Set the parentId (here set as 2) to the id of a category containing the objects you wish to be crawled by search engines
#
#RewriteRule ^sitemap.txt$          tiki-browse_categories.php?find=&deep=on&type=wiki+page&parentId=2&sort_mode=name_asc&links&maxRecords=1000000 [L]

# direct one-word access
RewriteRule ^(img\/trackers\/.*)   $1                                       [L]
RewriteRule ^calendar$             tiki-calendar.php                        [L]
RewriteRule ^articles$             tiki-view_articles.php                   [L]
RewriteRule ^blogs$                tiki-list_blogs.php                      [L]
RewriteRule ^categories$           tiki-browse_categories.php               [L]
RewriteRule ^chat$                 tiki-chat.php                            [L]
RewriteRule ^contact$              tiki-contact.php                         [L]
RewriteRule ^directories$          tiki-directory_browse.php                [L]
RewriteRule ^faqs$                 tiki-list_faqs.php                       [L]
RewriteRule ^filelist$             tiki-list_file_gallery.php               [L]
RewriteRule ^login$                tiki-login_scr.php                       [L]
RewriteRule ^logout$               tiki-logout.php                          [L]
# Note that email validation will not work if tiki-register.php is rewritten.
# RewriteRule ^register$             tiki-register.php                        [L]
RewriteRule ^my$                   tiki-my_tiki.php                         [L]
RewriteRule ^newsletters$          tiki-newsletters.php                     [L]
RewriteRule ^quizzes$              tiki-list_quizzes.php                    [L]
RewriteRule ^sheets$               tiki-sheets.php                          [L]
RewriteRule ^stats$                tiki-stats.php                           [L]
RewriteRule ^surveys$              tiki-list_surveys.php                    [L]
RewriteRule ^trackers$             tiki-list_trackers.php                   [L]
RewriteRule ^users$                tiki-list_users.php                      [L]
RewriteRule ^userinfo$          tiki-view_tracker_item.php?view=+user&cookietab=2 [L]

# access a link to any user by providing its username (exact match) after u:
#   (uncomment to enable)
#RewriteRule ^u:([A-Za-z0-9]+)       tiki-view_tracker_item.php?user=$1&view=+user           [QSA,L]
# alternative procedure to show a list of users with that string 
#   (adapt with your user tracker id and user selector field id)
#RewriteRule ^u:([A-Za-z0-9]+)       tiki-view_tracker.php?trackerId=1&filterfield=3&filtervalue\[3\]=$1           [QSA,L]

# access any object by its numeric identifier
RewriteRule ^article([0-9]+)\-.*(&comzone=.*)$  article$1$2
RewriteRule ^article([0-9]+)\-.*$  article$1
RewriteRule ^blog([0-9]+)\-.*$     blog$1
RewriteRule ^blog$ blog1
RewriteRule ^blogpost([0-9]+)\-.*$ blogpost$1
RewriteRule ^article([0-9]+)(.*)   tiki-read_article.php?articleId=$1$2     [QSA,L]
RewriteRule ^art([0-9]+)(.*)       tiki-read_article.php?articleId=$1$2     [QSA,L]

# The following supports up to seven merged calendars; most to least. SEWilco 2008-07-15
RewriteRule ^cal([0-9]+),([0-9]+),([0-9]+),([0-9]+),([0-9]+),([0-9]+),([0-9]+)  tiki-calendar.php?calIds[]=$1&calIds[]=$2&calIds[]=$3&calIds[]=$4&calIds[]=$5&calIds[]=$6&calIds[]=$7 [QSA,L]
RewriteRule ^cal([0-9]+),([0-9]+),([0-9]+),([0-9]+),([0-9]+),([0-9]+)  tiki-calendar.php?calIds[]=$1&calIds[]=$2&calIds[]=$3&calIds[]=$4&calIds[]=$5&calIds[]=$6 [QSA,L]
RewriteRule ^cal([0-9]+),([0-9]+),([0-9]+),([0-9]+),([0-9]+)  tiki-calendar.php?calIds[]=$1&calIds[]=$2&calIds[]=$3&calIds[]=$4&calIds[]=$5 [QSA,L]
RewriteRule ^cal([0-9]+),([0-9]+),([0-9]+),([0-9]+)  tiki-calendar.php?calIds[]=$1&calIds[]=$2&calIds[]=$3&calIds[]=$4 [QSA,L]
RewriteRule ^cal([0-9]+),([0-9]+),([0-9]+)  tiki-calendar.php?calIds[]=$1&calIds[]=$2&calIds[]=$3 [QSA,L]
RewriteRule ^cal([0-9]+),([0-9]+)  tiki-calendar.php?calIds[]=$1&calIds[]=$2 [QSA,L]
RewriteRule ^cal([0-9]+)           tiki-calendar.php?calIds[]=$1            [QSA,L]

RewriteRule ^cat([0-9]+)\-?[^&]*(.*)       tiki-browse_categories.php?parentId=$1$2 [QSA,L]
RewriteRule ^blog([0-9]+)(.*)      tiki-view_blog.php?blogId=$1$2           [QSA,L]
RewriteRule ^blogpost([0-9]+)(.*)  tiki-view_blog_post.php?postId=$1$2      [QSA,L]
RewriteRule ^browseimage([0-9]+)(.*) tiki-browse_image.php?imageId=$1$2     [QSA,L]
RewriteRule ^directory([0-9]+)(.*) tiki-directory_browse.php?parent=$1$2    [QSA,L]
RewriteRule ^dirlink([0-9]+)       tiki-directory_redirect.php?siteId=$1    [QSA,L]
RewriteRule ^faq([0-9]+)(.*)       tiki-view_faq.php?faqId=$1$2             [QSA,L]
RewriteRule ^file([0-9]+)(.*)      tiki-list_file_gallery.php?galleryId=$1$2 [QSA,L]
RewriteRule ^dl([0-9]+)(.*)        tiki-download_file.php?fileId=$1$2       [QSA,L]
RewriteRule ^thumbnail([0-9]+)(.*) tiki-download_file.php?fileId=$1&thumbnail$2 [QSA,L]
RewriteRule ^display([0-9]+)(.*)   tiki-download_file.php?fileId=$1&display$2 [QSA,L]
RewriteRule ^preview([0-9]+)(.*)   tiki-download_file.php?fileId=$1&preview$2 [QSA,L]
RewriteRule ^gallery([0-9]+)(.*)   tiki-browse_gallery.php?galleryId=$1$2   [QSA,L]
RewriteRule ^img([0-9]+)(.*)       show_image.php?id=$1$2                   [QSA,L]
RewriteRule ^image([0-9]+)(.*)     show_image.php?id=$1$2                   [QSA,L]
RewriteRule ^imagescale([0-9]+)/([0-9]+)(.*) show_image.php?id=$1&scalesize=$2$3  [QSA,L]
RewriteRule ^newsletter([0-9]+)(.*) tiki-newsletters.php?nlId=$1$2&info=1    [QSA,L]
RewriteRule ^quiz([0-9]+)(.*)      tiki-take_quiz.php?quizId=$1$2           [QSA,L]
RewriteRule ^survey([0-9]+)(.*)    tiki-take_survey.php?surveyId=$1$2       [QSA,L]
RewriteRule ^tracker([0-9]+)(.*)   tiki-view_tracker.php?trackerId=$1$2     [QSA,L]
RewriteRule ^item([0-9]+)(.*)      tiki-view_tracker_item.php?itemId=$1$2   [QSA,L]
RewriteRule ^int([0-9]+)(.*)       tiki-integrator.php?repID=$1$2           [QSA,L]
RewriteRule ^sheet([0-9]+)(.*)     tiki-view_sheets.php?sheetId=$1$2        [QSA,L]
RewriteRule ^poll([0-9]+)(.*)      tiki-poll_form.php?pollId=$1$2           [QSA,L]
RewriteRule ^wiki-([A-Za-z0-9]+)   tiki-index.php?page=$1                   [QSA,L]
RewriteRule ^page-([A-Za-z0-9]+)   tiki-index.php?page=$1                   [QSA,L]
RewriteRule ^show:(~?)(.+)$        tiki-slideshow.php?page=$1$2             [QSA,L]
RewriteRule ^user([0-9]+)(.*)      tiki-user_information.php?userId=$1$2    [QSA,L]
RewriteRule ^(lib/wiki3d/.+\.jar)$ $1                                       [L]

# Stop processing filenames here, so that 404 errors are returned (for example if the URL contains a typo like tiki-indexx.php) rather than being interpreted as a match to a broad rule.
# "Dirty URL"s will stop here.
RewriteRule \.(css|gif|jpg|png|php|html|js|htm|shtml|cgi|sql|phtml|txt|ihtml)   -       [last]

#Redirect addresses with bogus directories: e.g., example.com/bogus/.*
#Otherwise causes a broken page to load
#RewriteRule ^.*/.*$ http://www.example.com/Page+Not+Found    [L]


RewriteRule ^tiki-([a-z_]+)-([a-z_]+) tiki-ajax_services.php?controller=$1&action=$2		[QSA,L]
RewriteRule ^tiki-([a-z_]+)         tiki-ajax_services.php?controller=$1		[QSA,L] # action may be specified in request body (POST)
RewriteRule ^(.+)$                 tiki-index.php?page=$1                   [QSA,L]

</IfModule>

# Start CloudFlare:orionrobots.co.uk rewrite. Do not Edit 
RewriteEngine On 
RewriteCond %{HTTP_HOST} ^orionrobots.co.uk 
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L] 
# End CloudFlare rewrite. 